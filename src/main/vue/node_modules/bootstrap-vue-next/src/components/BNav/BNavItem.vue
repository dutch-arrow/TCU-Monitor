<template>
  <li class="nav-item">
    <BLink
      class="nav-link"
      :class="linkClasses"
      v-bind="{...linkProps, ...linkAttrs}"
      active-class="active"
      :tabindex="disabledBoolean ? -1 : undefined"
      :aria-disabled="disabledBoolean ? true : undefined"
    >
      <slot />
    </BLink>
  </li>
</template>

<script setup lang="ts">
import {computed} from 'vue'
import BLink from '../BLink/BLink.vue'
import {useBooleanish} from '../../composables'
import type {BLinkProps} from '../../types/BLinkProps'
import {pluckProps} from '../../utils'

defineSlots<{
  // eslint-disable-next-line @typescript-eslint/no-explicit-any
  default?: (props: Record<string, never>) => any
}>()

const props = withDefaults(
  defineProps<
    {
      linkClasses?: string
      linkAttrs?: Record<string, unknown>
    } & Omit<BLinkProps, 'event' | 'routerTag'>
  >(),
  {
    linkClasses: undefined,
    // Link props
    active: undefined,
    activeClass: 'router-link-active',
    append: false,
    linkAttrs: undefined,
    disabled: false,
    href: undefined,
    // noPrefetch: {type: [Boolean, String] as PropType<Booleanish>, default: false},
    // prefetch: {type: [Boolean, String] as PropType<Booleanish>, default: null},
    rel: undefined,
    replace: false,
    routerComponentName: 'router-link',
    target: '_self',
    to: undefined,
    variant: undefined,
    opacity: undefined,
    opacityHover: undefined,
    underlineVariant: null,
    underlineOffset: undefined,
    underlineOffsetHover: undefined,
    underlineOpacity: undefined,
    underlineOpacityHover: undefined,
    icon: false,
    // End link props
  }
)

const disabledBoolean = useBooleanish(() => props.disabled)

const linkProps = computed(() =>
  pluckProps(props, {
    active: true,
    activeClass: true,
    append: true,
    disabled: true,
    href: true,
    icon: true,
    opacity: true,
    opacityHover: true,
    rel: true,
    replace: true,
    routerComponentName: true,
    target: true,
    to: true,
    underlineOffset: true,
    underlineOffsetHover: true,
    underlineOpacity: true,
    underlineOpacityHover: true,
    underlineVariant: true,
    variant: true,
  } satisfies Record<keyof Omit<BLinkProps, 'event' | 'routerTag'>, true>)
)
</script>
